# راهنمای ضبط کننده ماکرو (Macro Recorder)

## نیازمندی‌ها
- **پایتون 3.6 یا بالاتر**
- کتابخانه‌های مورد نیاز:
  - `pyautogui`
  - `keyboard`
  - `pynput`
  - `tkinter` (معمولاً همراه با پایتون نصب می‌شود)
  - `pywin32` (برای ویندوز)

## معرفی
این اسکریپت یک ضبط کننده ماکرو است که به شما امکان می‌دهد حرکات موس، کلیک‌ها و ورودی‌های صفحه کلید را ضبط کنید و آن‌ها را در فایل‌های متنی ذخیره کنید. این ابزار برای اتوماسیون کارهای تکراری در ویندوز مفید است.

## نصب
1. پایتون 3.6 یا بالاتر را نصب کنید.
2. کتابخانه‌های مورد نیاز را با استفاده از فایل `requirements.txt` نصب کنید:
   ```
   pip install -r requirements.txt
   ```

## نحوه استفاده

### شروع ضبط
1. فایل `macro_recorder.py` را اجرا کنید:
   ```
   python macro_recorder.py
   ```
2. دکمه `F6` را فشار دهید تا ضبط شروع شود (یک پیام "Recording" نمایش داده می‌شود).
3. اکنون می‌توانید حرکات موس، کلیک‌ها و ورودی‌های صفحه کلید خود را انجام دهید.

### پایان ضبط
1. برای پایان ضبط، دوباره دکمه `F6` را فشار دهید.
2. ماکرو به صورت خودکار در یک فایل متنی با نام شماره‌ای (مانند `1.txt`، `2.txt` و غیره) در همان پوشه‌ای که اسکریپت قرار دارد ذخیره می‌شود.

## فرمت خروجی
فایل خروجی با مسیر کامل فایل شروع می‌شود و شامل دستورات زیر است:

### مسیر فایل
```
@C:/Users/Username/Desktop/Recorder/1.txt
```

### حرکات موس
```
Click, X, Y, 0
```

### کلیک‌های موس
```
Click, X, Y Left, , Down
Sleep, 50
Click, X, Y Left, , Up
```

### ورودی‌های صفحه کلید
```
Send, {Key Down}
Sleep, 50
Send, {Key Up}
```

### تاخیر
```
Sleep, میلی‌ثانیه
```

## ویژگی‌ها
- ضبط حرکات موس با کاهش حجم فایل (فقط تغییرات مهم ضبط می‌��وند)
- ضبط کلیک‌های موس (چپ، راست، وسط)
- ضبط ورودی‌های صفحه کلید
- ضبط تاخیرها بین اقدامات
- ذخیره‌سازی خودکار با شماره‌گذاری فایل‌ها
- فرمت خروجی سازگار با اسکریپت‌های ماکرو

## تنظیمات پیشرفته
برای تغییر تنظیمات پیشرفته، می‌توانید فایل `macro_recorder.py` را ویرایش کنید:

- `mouse_threshold`: حداقل پیکسل‌های حرکت موس برای ضبط (پیش‌فرض: 15)
- `min_delay_between_moves`: حداقل زمان بین ضبط‌های حرکت موس (پیش‌فرض: 50 میلی‌ثانیه)
- `action_key`: کلید میانبر برای شروع/پایان ضبط (پیش‌فرض: F6)

## عیب‌یابی
اگر با خطا مواجه شدید:

1. مطمئن شوید که پایتون 3.6 یا بالاتر نصب کرده‌اید.
2. بررسی کنید که همه کتابخانه‌های مورد نیاز با `pip install -r requirements.txt` نصب شده‌اند.
3. اگر خطای `ImportError` یا `ModuleNotFoundError` دریافت می‌کنید، دستی نصب کنید:
   ```
   pip install pyautogui keyboard pynput pywin32
   ```
4. اگر خطای دسترسی به ف��یل دارید، مطمئن شوید که دسترسی لازم برای ذخیره فایل در پوشه برنامه را دارید.
5. فایل `error_log.txt` را برای جزئیات بیشتر در مورد خطاها بررسی کنید.

## سازگاری
این اسکریپت با ویندوز 10 و 11 سازگار است و نیاز به پایتون 3.6 یا بالاتر دارد.

## امنیت
این ابزار فقط برای اتوماسیون کارهای شخصی طراحی شده است. لطفاً از آن برای اهداف غیر مجاز استفاده نکنید.